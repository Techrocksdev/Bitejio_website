import{D as y,R as C,r as j,c as _,j as a,L as g,s as d,i as w,h as k}from"./index-CO4A6BKl.js";import{a as I}from"./footer-Dosfl34H.js";var A=y();function D({item:e,refetch2:r,home:b}){const[c,l]=j.useState(""),[i,o]=j.useState(!1),{token:p,refetch:m}=_(),x=async()=>{if(!c){d("Please select combination","error");return}o(!0);const s={productId:e._id,variantId:c,quantity:1};try{const t=await w(s);t.error?t.error&&t.message==="Can't add product from different merchant"?document.getElementById("warnClick").click():d(t.message,"error"):(document.querySelector(`#cartModal${e._id} [data-bs-dismiss="modal"]`).click(),d(t.message,"success"),Promise.all([m(),r()]))}catch{console.log("An error occurred")}finally{o(!1)}},h=async(s,t,f)=>{f.preventDefault();const u=s.cartQuantity+t;if(u<0)return;const v={productId:s._id,variantId:s.variant._id,quantity:u};try{const n=await k(v);n.error?d(n.message,"error"):(d(n.message,"success"),await Promise.all([m(),r()]))}catch{console.log("An error occurred")}},N=a.jsx("div",{className:"modal fade",id:`cartModal${e?._id}`,tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("div",{className:"modal-header",children:a.jsx("h2",{className:"modal-heading m-0",children:"Customise as per your taste"})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{className:"list-group",children:e?.variants?.map(s=>a.jsxs("label",{className:"list-group-item d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("input",{className:"form-check-input me-2",type:"radio",name:s._id,onChange:()=>l(s._id),checked:c===s._id}),s?.combination?.[0]?.attributeId?.name_en," (",s?.combination?.[0]?.valueId?.name_en,")"]}),a.jsxs("span",{children:[a.jsxs("del",{children:["₹",s.price]})," ",a.jsxs("strong",{className:"fw-bold ms-1",children:["₹",s.discountPrice]})]})]},s._id))}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[a.jsx("button",{className:"btn btn-light border","data-bs-dismiss":"modal",onClick:()=>l(""),children:"Cancel"}),a.jsx("button",{className:"comman-btn-main",onClick:()=>x(),disabled:i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"me-2",children:"Wait..."}),a.jsx(I,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Add to Cart"})]})]})]})})});return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:b?"":"col-md-4 col-lg-4 col-xl-4",children:a.jsx("div",{children:a.jsxs("div",{className:"custom-card wow animate__animated animate__fadeInUp","data-wow-delay":"0.2s",children:[a.jsx("div",{className:"custom-card-header",children:a.jsx(g,{to:`/product-details/${e?._id}`,children:a.jsx("img",{id:`product-img-${e._id}`,src:e?.images?.[0],alt:""})})}),a.jsxs("div",{className:"custom-card-body",children:[a.jsx("h2",{children:e?.name_en}),a.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[a.jsx("img",{src:"../assets/image/icons/Star.svg",className:"star",alt:""}),a.jsx("p",{className:"text",children:"4.8"}),a.jsx("p",{className:"text",children:e.userId?.shopName})]}),a.jsx("div",{className:"mt-4",children:a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsx("img",{src:"../assets/image/icons/watch.svg",alt:""}),a.jsx("p",{className:"text",children:"30-40 min"})]}),p?e?.isAddedInCart&&e.cartQuantity>0?a.jsx("div",{className:"d-flex align-items-center",children:a.jsxs("div",{className:"add-btn",children:[a.jsx("button",{onClick:s=>h(e,-1,s),disabled:e?.cartQuantity<=0,children:a.jsx("i",{className:"fa fa-minus"})}),a.jsx("button",{children:e?.cartQuantity}),a.jsx("button",{onClick:s=>h(e,1,s),children:a.jsx("i",{className:"fa fa-plus"})})]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":`#cartModal${e?._id}`,onClick:s=>{s.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":"#addressModal",onClick:s=>{s.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})})]})})]})]})})},e?._id),A.createPortal(N,document.body),a.jsx("div",{className:"modal fade logoutmodal",id:"Warn",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsx("div",{className:"modal-content",children:a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"paymentmodal_main text-center",children:[a.jsxs("div",{className:"payment_head mb-3 mt-1",children:[a.jsx("h2",{children:"Oops!"}),a.jsx("p",{children:"Your cart already contains items from a different merchant. To add this item, you’ll need to clear your existing cart."})]}),a.jsxs("div",{className:"row justify-content-center mb-2",children:[a.jsx("div",{className:"col-auto",children:a.jsx("button",{className:"comman-btn-main",onClick:()=>x(),children:"Add to Cart"})}),a.jsx("div",{className:"col-auto",children:a.jsx(g,{className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>l(""),children:"Cancel"})})]})]})})})})}),a.jsx("div",{className:"d-none",id:"warnClick","data-bs-toggle":"modal","data-bs-target":"#Warn"})]})}const $=C.memo(D);export{$ as P,A as r};
