import{R as A,a as j,e as C,b as P,j as s,L as _,c as k,s as t,f as D,h as S,i as q}from"./index-CcC7UsB8.js";import{H as L,a as O,F}from"./footer-ClRepmvB.js";import{S as i}from"./skeleton-CYVYWcuS.js";import{A as Y}from"./addressCart-GL0Y_wTj.js";function E(){const[n,N]=j.useState({}),[d,f]=j.useState(20),[u,y]=j.useState(!1),b=C(),{data:r,isLoading:o,refetch:v}=P({queryKey:["cartList"],queryFn:q,select:e=>e.results.carts[0]}),w=async(e,c)=>{const l={productId:e,variantId:c};console.log(l);try{const a=await D(l);a.error?t(a.message,"error"):(t(a.message,"success"),v())}catch{console.log("An error occurred")}},g=async(e,c)=>{const l=e.quantity+c;if(l<1)return;const a={productId:e.productId._id,variantId:e.variantId._id,quantity:l};try{const m=await k(a);m.error?t(m.message,"error"):(t(m.message,"success"),v())}catch{console.log("An error occurred")}},h=e=>{f(e.target.value)},x=r?.products?.reduce((e,c)=>e+c.variantId.price*c.quantity,0),p=r?.products?.reduce((e,c)=>e+(c.variantId.discountPrice||0)*c.quantity,0),I=async()=>{const e={address_line1:n?.address_line1,address_line2:n?.address_line2,postal_code:n?.postal_code,city:n?.city,country:n?.country,latitude:n?.latitude,longitude:n?.longitude,type:n?.type},l={products:r?.products?.map(a=>({productId:a.productId._id,variantId:a.variantId._id,merchantId:a.userId,quantity:a.quantity,amount:a.variantId.price,paidAmount:0,discount:a.variantId.discountPrice,advancePayment:0})),address:e,amount:x,paidAmount:d,discount:p};try{const a=await S(l);a.error?t(a.message,"error"):(t(a.message,"success"),b("/order-confirmed"))}catch{console.log("An error occurred")}finally{y(!1)}};return s.jsxs(s.Fragment,{children:[s.jsx(L,{}),s.jsx("section",{className:"checkout",children:s.jsxs("div",{className:"container comman-spacing-top-bottom",children:[s.jsx("h2",{className:"heading",children:"Checkout"}),s.jsx("div",{className:"comman-spacing-top-bottom",children:r?.products?.length||o?s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-md-7 col-lg-8",children:[s.jsxs("div",{className:"rounded-3 bg-white overflow-hidden px-2 py-2",children:[o?[...Array(5)].map((e,c)=>s.jsxs("div",{className:"cart-item d-flex align-items-center justify-content-between mb-3",children:[s.jsxs("div",{className:"col-12 col-md-7 col-lg-6 d-flex align-items-center gap-2",children:[s.jsx("div",{className:"cart-img",children:s.jsx(i,{})}),s.jsxs("div",{className:"w-100",children:[s.jsx("h6",{className:"product-heading",children:s.jsx(i,{style:{width:"100%"}})}),s.jsx("small",{className:"text-muted",children:s.jsx(i,{style:{width:"100%"}})}),s.jsxs("p",{className:"fw-bold mb-0 mt-2",children:[" ",s.jsx(i,{style:{width:"100%"}})]})]})]}),s.jsx("div",{className:"col-12 col-md-5 col-lg-6 d-flex align-items-center justify-content-end gap-2",children:s.jsxs("div",{className:"w-100 text-end",children:[" ",s.jsx(i,{height:40,style:{width:"30%"}})]})})]},c)):r?.products?.map(e=>s.jsxs("div",{className:"cart-item d-flex align-items-center justify-content-between mb-3",children:[s.jsxs("div",{className:"col-12 col-md-7 col-lg-6 d-flex align-items-center gap-2",children:[s.jsx("div",{className:"cart-img",children:s.jsx("img",{src:e?.productId?.images?.[0],className:"rounded",alt:e?.productId?.images?.[0]})}),s.jsxs("div",{children:[s.jsx("h6",{className:"product-heading",children:e.productId.name_en}),s.jsx("small",{className:"text-muted",children:e.productId.userId.shopname}),s.jsxs("p",{className:"fw-bold mb-0 mt-2",children:["₹",e?.variantId?.price]})]})]}),s.jsxs("div",{className:"col-12 col-md-5 col-lg-6 d-flex align-items-center justify-content-end gap-2",children:[s.jsxs("div",{className:"add-btn",children:[s.jsx("button",{onClick:()=>g(e,-1),disabled:e?.quantity<=1,children:"-"}),s.jsx("button",{children:e?.quantity}),s.jsx("button",{onClick:()=>g(e,1),children:"+"})]}),s.jsx("div",{onClick:()=>w(e.productId._id,e.variantId._id),style:{cursor:"pointer"},children:s.jsx("img",{src:"assets/image/icons/Trash.svg",alt:""})})]})]},e?.productId?._id)),o?"":s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"border-top pt-3"}),s.jsxs("div",{className:"bill-details mt-3",children:[s.jsx("h2",{className:"heading",children:"Bill details"}),s.jsxs("p",{className:"d-flex justify-content-between mb-1",children:[s.jsx("span",{children:"Subtotal"})," ",s.jsxs("span",{children:["₹",x||0]})]}),s.jsxs("p",{className:"d-flex justify-content-between mb-1",children:[s.jsx("span",{children:"Taxes & Charges"})," ",s.jsx("span",{children:"₹15"})]}),s.jsxs("p",{className:"d-flex justify-content-between mb-3",children:[s.jsx("span",{children:"Delivery Charges"})," ",s.jsx("span",{children:"₹20"})]}),s.jsxs("p",{className:"d-flex justify-content-between mb-3",children:[s.jsx("span",{children:"Discount"})," ",s.jsxs("span",{children:["₹",p||0]})]}),s.jsxs("h6",{className:"d-flex justify-content-between fw-bold",children:[s.jsx("span",{children:"Total Payable"})," ",s.jsxs("span",{children:["₹",x+15+20-p]})]})]})]})]}),o?"":s.jsx("div",{className:"mt-3",children:s.jsxs("div",{className:"rounded-3 bg-white overflow-hidden px-3 py-3",children:[s.jsx("h2",{className:"heading",children:"Delivery Address"}),s.jsx(Y,{setAddDetail:N,addDetail:n})]})})]}),o?s.jsx("div",{className:"col-md-5 col-lg-4",children:s.jsxs("div",{className:"rounded-3 bg-white overflow-hidden px-3 py-4",children:[s.jsx("h2",{children:s.jsx(i,{})}),s.jsx("h2",{className:"mt-3",children:s.jsx(i,{})}),s.jsx("h2",{className:"mt-3",children:s.jsx(i,{})}),s.jsx("h2",{className:"mt-3",children:s.jsx(i,{})})]})}):s.jsx("div",{className:"col-md-5 col-lg-4",children:s.jsxs("div",{className:"rounded-3 bg-white overflow-hidden px-3 py-4",children:[s.jsx("h2",{children:"Payment Option"}),s.jsx("div",{className:"payment-option mt-4",children:s.jsxs("label",{className:"d-flex gap-3 align-items-center",style:{cursor:"pointer"},children:[s.jsx("input",{type:"radio",name:"payment-method",value:"20-percent",checked:d===20,onChange:h,className:"custom-radio"}),s.jsx("div",{children:"Pay 20% Now, Rest on Delivery"})]})}),s.jsx("div",{className:"payment-option mt-4",children:s.jsxs("label",{className:"d-flex gap-3 align-items-center",style:{cursor:"pointer"},children:[s.jsx("input",{type:"radio",name:"payment-method",value:"100-percent",checked:d===100,onChange:h,className:"custom-radio"}),s.jsx("div",{children:"Pay 100% Online"})]})}),s.jsx("div",{className:"payment-option mt-4",children:s.jsxs("label",{className:"d-flex gap-3 align-items-center",style:{cursor:"pointer"},children:[s.jsx("input",{type:"radio",name:"payment-method",value:"cod",checked:d===0,onChange:h,className:"custom-radio"}),s.jsx("div",{children:"Cash on Delivery"})]})}),s.jsx("div",{className:"mt-3",children:s.jsx("button",{className:"d-block comman-btn-main w-100",disabled:u,onClick:()=>I(),children:u?s.jsxs(s.Fragment,{children:[s.jsx(O,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0}),s.jsx("span",{className:"ms-2",children:" Wait.."})]}):d===0?"Place Order":"Pay Now"})}),s.jsx("div",{className:"mt-3",children:s.jsx("div",{className:"secure-payment-card",children:s.jsxs("div",{className:"d-flex gap-2",children:[s.jsx("img",{src:"assets/image/icons/sheild-green.svg",alt:""}),s.jsxs("div",{children:[s.jsx("p",{className:"m-0 fw-semibold",children:"Secure Payment"}),s.jsx("p",{className:"m-0",children:"Your payment information is encrypted and secure"})]})]})})})]})})]}):s.jsxs("div",{className:"mt-3 no-data mx-auto d-flex flex-column justify-content-center align-items-center",children:[s.jsx("img",{src:"../assets/image/products/noData.avif",alt:"nodata",loading:"lazy"}),s.jsx("h1",{children:"Your cart is empty"}),s.jsx("p",{children:"You can go to home page to view more products"}),s.jsx(_,{className:"comman-btn-main",to:"/",children:"Home"})]})})]})}),s.jsx(F,{}),s.jsxs("div",{class:"offcanvas offcanvas-end",tabindex:"-1",id:"couponOffcanvas","aria-labelledby":"couponOffcanvasLabel",children:[s.jsxs("div",{className:"offcanvas-header",children:[s.jsx("h5",{id:"couponOffcanvasLabel",children:"All Coupons"}),s.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})]}),s.jsx("div",{className:"offcanvas-body",children:s.jsx("div",{className:"coupon-list",children:s.jsxs("div",{className:"coupon-item",children:[s.jsx("div",{className:"coupon-card p-0 bg-transparent",children:s.jsxs("div",{className:"row g-3",children:[s.jsx("di",{className:"col-8",children:s.jsxs("div",{className:"coupon-input",children:[s.jsx("input",{type:"text",className:"form-control"}),s.jsx("img",{src:"assets/image/icons/percentage.svg",className:"icon",alt:""})]})}),s.jsx("di",{className:"col-4",children:s.jsx("button",{className:"comman-btn-main",children:"Apply"})})]})}),s.jsxs("div",{className:"mt-4",children:[s.jsx("h2",{className:"heading",children:"Available offers"}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("div",{className:"coupon-card-items",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("img",{src:"assets/image/icons/percentage.svg",alt:""}),s.jsx("div",{className:"offer",children:"SAVE20"})]}),s.jsx("p",{className:"apply",children:"Apply"})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"save",children:"You save ₹50"}),s.jsx("p",{className:"percentage-offer-dis",children:"5% off entire order on minimum of ₹200"})]})]}),s.jsxs("div",{className:"coupon-card-items",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("img",{src:"assets/image/icons/percentage.svg",alt:""}),s.jsx("div",{className:"offer",children:"SAVE20"})]}),s.jsx("p",{className:"apply",children:"Apply"})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"save",children:"You save ₹50"}),s.jsx("p",{className:"percentage-offer-dis",children:"5% off entire order on minimum of ₹200"})]})]}),s.jsxs("div",{className:"coupon-card-items",children:[s.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[s.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[s.jsx("img",{src:"assets/image/icons/percentage.svg",alt:""}),s.jsx("div",{className:"offer",children:"SAVE20"})]}),s.jsx("p",{className:"apply",children:"Apply"})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("p",{className:"save",children:"You save ₹50"}),s.jsx("p",{className:"percentage-offer-dis",children:"5% off entire order on minimum of ₹200"})]})]})]})]})]})})})]})]})}const V=A.memo(E);export{V as default};
