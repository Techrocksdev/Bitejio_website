import{D as C,R as w,r as j,c as k,j as a,s as d,L as g,i as I,h as $}from"./index-DQotRUfC.js";import{a as M}from"./footer-D0usDuYn.js";var b=C();function A({item:s,refetch2:r,home:N}){const[n,c]=j.useState(""),[i,o]=j.useState(!1),{token:p,refetch:m}=k(),x=async()=>{if(!n){d("Please select combination","error");return}o(!0);const e={productId:s._id,variantId:n,quantity:1};try{const t=await I(e);t.error?d(t.message,"error"):(document.querySelector(`#cartModal${s._id} [data-bs-dismiss="modal"]`).click(),document.getElementById(`closeWarn${s._id}`)?.click(),c(""),d(t.message,"success"),Promise.all([m(),r()]))}catch{console.log("An error occurred")}finally{o(!1)}},h=async(e,t,y)=>{y.preventDefault();const u=e.cartQuantity+t;if(u<0)return;const _={productId:e._id,variantId:e.variant._id,quantity:u};try{const l=await $(_);l.error?d(l.message,"error"):(d(l.message,"success"),await Promise.all([m(),r()]))}catch{console.log("An error occurred")}},v=a.jsx("div",{className:"modal fade",id:`cartModal${s?._id}`,tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("div",{className:"modal-header",children:a.jsx("h2",{className:"modal-heading m-0",children:"Customise as per your taste"})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{className:"list-group",children:s?.variants?.map(e=>a.jsxs("label",{className:"list-group-item d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("input",{className:"form-check-input me-2",type:"radio",name:`variant-${s._id}`,onChange:()=>c(e._id),checked:n===e._id}),e?.combination?.[0]?.attributeId?.name_en," (",e?.combination?.[0]?.valueId?.name_en,")"]}),a.jsxs("span",{children:[a.jsxs("del",{children:["₹",e.price]})," ",a.jsxs("strong",{className:"fw-bold ms-1",children:["₹",e.discountPrice]})]})]},e._id))}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[a.jsx("button",{className:"btn btn-light border","data-bs-dismiss":"modal",onClick:()=>c(""),children:"Cancel"}),s.hasDifferentMerchantInCart?a.jsx("button",{className:"comman-btn-main",onClick:()=>{if(!n){d("Please select combination","error");return}document.getElementById(`warnClick${s._id}`).click()},children:"Add to Cart"}):a.jsx("button",{className:"comman-btn-main",onClick:()=>x(),disabled:i,children:i?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"me-2",children:"Wait..."}),a.jsx(M,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Add to Cart"})]})]})]})})}),f=a.jsx("div",{className:"modal fade logoutmodal",id:`Warn${s._id}`,tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsx("div",{className:"modal-content",children:a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"paymentmodal_main text-center",children:[a.jsxs("div",{className:"payment_head mb-3 mt-1",children:[a.jsx("h2",{children:"Oops!"}),a.jsx("p",{children:"Your cart already contains items from a different merchant. To add this item, you'll need to clear your existing cart."})]}),a.jsxs("div",{className:"row justify-content-center mb-2",children:[a.jsx("div",{className:"col-auto",children:a.jsx("button",{className:"comman-btn-main",onClick:()=>x(),children:"Add to Cart"})}),a.jsx("div",{className:"col-auto",children:a.jsx(g,{id:`closeWarn${s._id}`,className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>{const e=document.getElementById(`cartModal${s._id}`),t=window.bootstrap?.Modal?.getInstance(e);t&&t.hide(),c("")},children:"Cancel"})})]})]})})})})});return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:N?"":"col-md-4 col-lg-4 col-xl-4",children:a.jsx("div",{children:a.jsxs("div",{className:"custom-card wow animate__animated animate__fadeInUp","data-wow-delay":"0.2s",children:[a.jsx("div",{className:"custom-card-header",children:a.jsx(g,{to:`/product-details/${s?._id}`,children:a.jsx("img",{id:`product-img-${s._id}`,src:s?.images?.[0],alt:""})})}),a.jsxs("div",{className:"custom-card-body",children:[a.jsx("h2",{children:s?.name_en}),a.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[a.jsx("img",{src:"../assets/image/icons/Star.svg",className:"star",alt:""}),a.jsx("p",{className:"text",children:"4.8"}),a.jsx("p",{className:"text",children:s.userId?.shopName})]}),a.jsx("div",{className:"mt-4",children:a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsx("img",{src:"../assets/image/icons/watch.svg",alt:""}),a.jsx("p",{className:"text",children:"30-40 min"})]}),p?s?.isAddedInCart&&s.cartQuantity>0?a.jsx("div",{className:"d-flex align-items-center",children:a.jsxs("div",{className:"add-btn",children:[a.jsx("button",{onClick:e=>h(s,-1,e),disabled:s?.cartQuantity<=0,children:a.jsx("i",{className:"fa fa-minus"})}),a.jsx("button",{children:s?.cartQuantity}),a.jsx("button",{onClick:e=>h(s,1,e),children:a.jsx("i",{className:"fa fa-plus"})})]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":`#cartModal${s?._id}`,onClick:e=>{e.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":"#addressModal",onClick:e=>{e.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})})]})})]})]})})},s?._id),b.createPortal(v,document.body),b.createPortal(f,document.body),a.jsx("div",{className:"d-none",id:`warnClick${s._id}`,"data-bs-toggle":"modal","data-bs-target":`#Warn${s._id}`})]})}const E=w.memo(A);export{E as P,b as r};
