import{R as v,b as p,u as N,j as e,L as C,d as _,s as c,e as w}from"./index-Di7fdAcO.js";import{a as k}from"./footer-zPgzVo4C.js";function I({item:a,refetch2:l,home:j}){const[o,m]=p.useState(""),[u,x]=p.useState(!1),{token:b,refetch:h}=N(),f=s=>{const n=document.querySelector(`#product-img-${a._id}`),i=document.querySelector(".addToCart");if(!n||!i){console.log("Product image or cart icon not found");return}const d=n.getBoundingClientRect(),r=i.getBoundingClientRect(),t=document.createElement("img");t.src=s,t.style.cssText=`
      position: fixed;
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 8px;
      z-index: 9999;
      left: ${d.left}px;
      top: ${d.top}px;
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      pointer-events: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    `,document.body.appendChild(t),setTimeout(()=>{t.style.left=`${r.left}px`,t.style.top=`${r.top}px`,t.style.width="40px",t.style.height="40px",t.style.opacity="0"},50),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},900)},y=async()=>{if(!o){c("Please select combination","error");return}x(!0);const s={productId:a._id,variantId:o,quantity:1};try{const n=await w(s);n.error?c(n.message,"error"):(document.querySelector(`#cartModal${a._id} [data-bs-dismiss="modal"]`).click(),c(n.message,"success"),await Promise.all([h(),l()]),setTimeout(()=>{f(a?.images?.[0])},300))}catch{console.log("An error occurred")}finally{x(!1)}},g=async(s,n,i)=>{i.preventDefault();const d=s.cartQuantity+n;if(d<0)return;const r={productId:s._id,variantId:s.variant._id,quantity:d};try{const t=await _(r);t.error?c(t.message,"error"):(c(t.message,"success"),h(),l())}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:j?"me-4":"col-md-4 col-lg-4 col-xl-4",children:e.jsx(C,{to:`/product-details/${a?._id}`,children:e.jsxs("div",{className:"custom-card wow animate__animated animate__fadeInUp","data-wow-delay":"0.2s",children:[e.jsx("div",{className:"custom-card-header",children:e.jsx("img",{id:`product-img-${a._id}`,src:a?.images?.[0],alt:""})}),e.jsxs("div",{className:"custom-card-body",children:[e.jsx("h2",{children:a?.name_en}),e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsx("img",{src:"../assets/image/icons/Star.svg",className:"star",alt:""}),e.jsx("p",{className:"text",children:"4.8"}),e.jsx("p",{className:"text",children:a.userId?.shopName})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"d-flex justify-content-between",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("img",{src:"../assets/image/icons/watch.svg",alt:""}),e.jsx("p",{className:"text",children:"30-40 min"})]}),b?a?.isAddedInCart&&a.cartQuantity>0?e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs("div",{className:"add-btn",children:[e.jsx("button",{onClick:s=>g(a,-1,s),disabled:a?.cartQuantity<=0,children:e.jsx("i",{className:"fa fa-minus"})}),e.jsx("button",{children:a?.cartQuantity}),e.jsx("button",{onClick:s=>g(a,1,s),children:e.jsx("i",{className:"fa fa-plus"})})]})}):e.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":`#cartModal${a?._id}`,onClick:s=>{s.preventDefault()},children:e.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[e.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})}):e.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":"#addressModal",onClick:s=>{s.preventDefault()},children:e.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[e.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})})]})})]})]})})},a?._id),e.jsx("div",{className:"modal fade",id:`cartModal${a?._id}`,tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header",children:e.jsx("h2",{className:"modal-heading m-0",children:"Customise as per your taste"})}),e.jsxs("div",{className:"modal-body",children:[e.jsx("div",{className:"list-group",children:a?.variants?.map(s=>e.jsxs("label",{className:"list-group-item d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("input",{className:"form-check-input me-2",type:"radio",name:s._id,onChange:()=>m(s._id),checked:o===s._id}),s?.combination?.[0]?.attributeId?.name_en," (",s?.combination?.[0]?.valueId?.name_en,")"]}),e.jsxs("span",{className:"fw-bold",children:["â‚¹",s.price]})]},s._id))}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[e.jsx("button",{className:"btn btn-light border","data-bs-dismiss":"modal",onClick:()=>m(""),children:"Cancel"}),e.jsx("button",{className:"comman-btn-main",onClick:()=>y(),disabled:u,children:u?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"me-2",children:"Wait..."}),e.jsx(k,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Add to Cart"})]})]})]})})})]})}const Q=v.memo(I);export{Q as P};
