import{D as w,R as _,r as g,c as k,j as a,L as b,s as n,i as I,h as A}from"./index-BvhRGpYf.js";import{a as D}from"./footer-fciGMMzT.js";var p=w();function M({item:e,refetch2:o,home:N}){const[l,r]=g.useState(""),[m,x]=g.useState(!1),{token:f,refetch:h}=k(),u=async()=>{if(!l){n("Please select combination","error");return}x(!0);const s={productId:e._id,variantId:l,quantity:1};try{const t=await I(s);if(!t.error)document.querySelector(`#cartModal${e._id} [data-bs-dismiss="modal"]`).click(),r(""),n(t.message,"success"),Promise.all([h(),o()]);else if(t.error&&t.message==="Can't add product from different merchant"){const i=document.getElementById(`cartModal${e._id}`),d=window.bootstrap.Modal.getInstance(i);d&&d.hide(),setTimeout(()=>{document.getElementById("warnClick").click()},300)}else n(t.message,"error")}catch{console.log("An error occurred")}finally{x(!1)}},j=async(s,t,i)=>{i.preventDefault();const d=s.cartQuantity+t;if(d<0)return;const C={productId:s._id,variantId:s.variant._id,quantity:d};try{const c=await A(C);c.error?n(c.message,"error"):(n(c.message,"success"),await Promise.all([h(),o()]))}catch{console.log("An error occurred")}},v=a.jsx("div",{className:"modal fade",id:`cartModal${e?._id}`,tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsxs("div",{className:"modal-content",children:[a.jsx("div",{className:"modal-header",children:a.jsx("h2",{className:"modal-heading m-0",children:"Customise as per your taste"})}),a.jsxs("div",{className:"modal-body",children:[a.jsx("div",{className:"list-group",children:e?.variants?.map(s=>a.jsxs("label",{className:"list-group-item d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsx("input",{className:"form-check-input me-2",type:"radio",name:s._id,onChange:()=>r(s._id),checked:l===s._id}),s?.combination?.[0]?.attributeId?.name_en," (",s?.combination?.[0]?.valueId?.name_en,")"]}),a.jsxs("span",{children:[a.jsxs("del",{children:["₹",s.price]})," ",a.jsxs("strong",{className:"fw-bold ms-1",children:["₹",s.discountPrice]})]})]},s._id))}),a.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-4",children:[a.jsx("button",{className:"btn btn-light border","data-bs-dismiss":"modal",children:"Cancel"}),a.jsx("button",{className:"comman-btn-main",onClick:()=>u(),disabled:m,children:m?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"me-2",children:"Wait..."}),a.jsx(D,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Add to Cart"})]})]})]})})}),y=a.jsx("div",{className:"modal fade logoutmodal",id:"Warn",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:a.jsx("div",{className:"modal-dialog modal-dialog-centered",children:a.jsx("div",{className:"modal-content",children:a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"paymentmodal_main text-center",children:[a.jsxs("div",{className:"payment_head mb-3 mt-1",children:[a.jsx("h2",{children:"Oops!"}),a.jsx("p",{children:"Your cart already contains items from a different merchant. To add this item, you'll need to clear your existing cart."})]}),a.jsxs("div",{className:"row justify-content-center mb-2",children:[a.jsx("div",{className:"col-auto",children:a.jsx("button",{className:"comman-btn-main",onClick:()=>u(),children:"Add to Cart"})}),a.jsx("div",{className:"col-auto",children:a.jsx(b,{className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>r(""),children:"Cancel"})})]})]})})})})});return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:N?"":"col-md-4 col-lg-4 col-xl-4",children:a.jsx("div",{children:a.jsxs("div",{className:"custom-card wow animate__animated animate__fadeInUp","data-wow-delay":"0.2s",children:[a.jsx("div",{className:"custom-card-header",children:a.jsx(b,{to:`/product-details/${e?._id}`,children:a.jsx("img",{id:`product-img-${e._id}`,src:e?.images?.[0],alt:""})})}),a.jsxs("div",{className:"custom-card-body",children:[a.jsx("h2",{children:e?.name_en}),a.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[a.jsx("img",{src:"../assets/image/icons/Star.svg",className:"star",alt:""}),a.jsx("p",{className:"text",children:"4.8"}),a.jsx("p",{className:"text",children:e.userId?.shopName})]}),a.jsx("div",{className:"mt-4",children:a.jsxs("div",{className:"d-flex justify-content-between",children:[a.jsxs("div",{className:"d-flex align-items-center gap-2",children:[a.jsx("img",{src:"../assets/image/icons/watch.svg",alt:""}),a.jsx("p",{className:"text",children:"30-40 min"})]}),f?e?.isAddedInCart&&e.cartQuantity>0?a.jsx("div",{className:"d-flex align-items-center",children:a.jsxs("div",{className:"add-btn",children:[a.jsx("button",{onClick:s=>j(e,-1,s),disabled:e?.cartQuantity<=0,children:a.jsx("i",{className:"fa fa-minus"})}),a.jsx("button",{children:e?.cartQuantity}),a.jsx("button",{onClick:s=>j(e,1,s),children:a.jsx("i",{className:"fa fa-plus"})})]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":`#cartModal${e?._id}`,onClick:s=>{s.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})}):a.jsx("button",{className:"comman-btn-main w-fit","data-bs-toggle":"modal","data-bs-target":"#addressModal",onClick:s=>{s.preventDefault()},children:a.jsxs("div",{className:"d-flex gap-2 align-items-center h-100",children:[a.jsx("img",{src:"../assets/image/icons/plus.svg",alt:""}),"Add"]})})]})})]})]})})},e?._id),p.createPortal(v,document.body),p.createPortal(y,document.body),a.jsx("div",{className:"d-none",id:"warnClick","data-bs-toggle":"modal","data-bs-target":"#Warn"})]})}const $=_.memo(M);export{$ as P,p as r};
